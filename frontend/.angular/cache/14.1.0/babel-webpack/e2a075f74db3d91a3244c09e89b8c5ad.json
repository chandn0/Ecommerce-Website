{"ast":null,"code":"import _classCallCheck from \"C:/Users/boina/Desktop/Finalproject/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/boina/Desktop/Finalproject/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport { HttpClient } from '@angular/common/http';\nimport { apiUrl } from '../../environments/environment';\nimport { BehaviorSubject, of } from 'rxjs';\nimport { UserService } from './user.service';\nimport { CookieService } from 'ngx-cookie-service';\nimport { ProductInfoMain } from '../models/product-info-main';\nimport { ProductService } from '../services/product.service';\nimport { ActivatedRoute } from '@angular/router';\nimport { catchError } from 'rxjs/operators';\nimport { Subject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"ngx-cookie-service\";\nimport * as i3 from \"./user.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"../services/product.service\";\nexport var WishListService = /*#__PURE__*/(function () {\n  var WishListService = /*#__PURE__*/function () {\n    function WishListService(http, cookieService, userService, route, productService) {\n      var _this = this;\n\n      _classCallCheck(this, WishListService);\n\n      this.http = http;\n      this.cookieService = cookieService;\n      this.userService = userService;\n      this.route = route;\n      this.productService = productService;\n      this.wishListUrl = \"\".concat(apiUrl, \"/wishlist\");\n      this.productUrl = \"\".concat(apiUrl, \"/product\");\n      this.localWishlist = {};\n      this.updateTerms = new Subject();\n      this.product = new ProductInfoMain();\n      this.itemsSubject = new BehaviorSubject(null);\n      this.items = this.itemsSubject.asObservable();\n      this.totalSubject = new BehaviorSubject(null);\n      this.total = this.totalSubject.asObservable();\n      this.userService.currentUser.subscribe(function (user) {\n        return _this.currentUser = user;\n      });\n    }\n\n    _createClass(WishListService, [{\n      key: \"getDetail\",\n      value: function getDetail(id) {\n        var url = \"\".concat(this.productUrl, \"/\").concat(id);\n        return this.http.get(url).pipe(catchError(function (_) {\n          console.log(\"Get Detail Failed\");\n          return of(new ProductInfoMain());\n        }));\n      }\n    }, {\n      key: \"getLocalWishList\",\n      value: function getLocalWishList(productId) {\n        var _this2 = this;\n\n        console.log(productId);\n        console.log(this.productService.getDetail(productId));\n        this.getDetail(productId).subscribe(function (product) {\n          return _this2.product = product;\n        });\n        return this.product;\n      }\n    }, {\n      key: \"getPage\",\n      value: function getPage() {\n        var page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n        var size = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 10;\n        return this.http.get(\"\".concat(this.wishListUrl, \"/list?page=\").concat(page, \"&size=\").concat(size)).pipe();\n      }\n    }, {\n      key: \"addToWishList\",\n      value: function addToWishList(productId) {\n        console.log(\"started service\"); // const localWishlist = this.getLocalWishList(productId);\n\n        console.log(productId);\n        var url = this.wishListUrl + '/add';\n\n        if (this.currentUser) {\n          console.log(\"if1\");\n\n          if (productId) {\n            console.log(\"if2\");\n            console.log(url);\n            this.http.post(url, productId);\n            return of(true);\n          } else {\n            // this.http.get<WishList>(this.wishListUrl);\n            return of(false);\n          }\n        }\n      }\n    }, {\n      key: \"removeFromWishList\",\n      value: function removeFromWishList(productId) {\n        var url = this.wishListUrl + '/delete/' + productId;\n\n        if (this.currentUser) {\n          return this.http.post(url, null); //  return of(true);\n        } else {\n          return of(false);\n        }\n      }\n    }, {\n      key: \"storeLocalWishList\",\n      value: function storeLocalWishList() {\n        this.cookieService.set('wishlist', JSON.stringify(this.localWishlist));\n      }\n    }, {\n      key: \"clearLocalWishList\",\n      value: function clearLocalWishList() {\n        console.log('clear local cart');\n        this.cookieService.delete('wishlist');\n        this.localWishlist = {};\n      }\n    }]);\n\n    return WishListService;\n  }();\n\n  WishListService.ɵfac = function WishListService_Factory(t) {\n    return new (t || WishListService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.CookieService), i0.ɵɵinject(i3.UserService), i0.ɵɵinject(i4.ActivatedRoute), i0.ɵɵinject(i5.ProductService));\n  };\n\n  WishListService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: WishListService,\n    factory: WishListService.ɵfac,\n    providedIn: 'root'\n  });\n  return WishListService;\n})();","map":null,"metadata":{},"sourceType":"module"}